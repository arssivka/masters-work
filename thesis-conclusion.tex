\chapter*{ЗАКЛЮЧЕНИЕ}
\addcontentsline{toc}{chapter}{ЗАКЛЮЧЕНИЕ}

Основная цель работы заключалась разработке 
высокопроизводительной модульной программной системы для 
мобильных робототехнических комплексов. На сегодняшний день 
большинство робототехнических фреймворков обеспечивают 
модульность и возможность эффективного переиспользования 
программного кода, но накладывают существенные ограничения на 
производительность, что пагубно отражается при их использовании 
на мобильных платформах. Интерес представляет ROS 2.0, который 
по заявлению разработчкиков должен преодолеть ограничения 
популярной в исследовательских кругах ROS, но затачивается для 
эффективной работы через сетевые протоколы. Так же стоит 
заметить, что большинство робототехнических фреймворков 
используют исполнение в нескольких процессах, что требует 
активного взаимодействия с операционной системой.

В данной работе проектирование модульной системы предполагается 
в рамках единого адресного пространства на основе 
многопоточности с минимизацией количества системных вызовов. 
Современные исследования в области межпоточного взаимодействия и 
высокопроизводительных систем показывают существенный прирост 
быстродействия многопоточных систем с использованием алгоритмов 
без блокировок. Архитектура ядра системы разрабатывалась с 
использованием очереди без блокировок для повышения 
производительности области кода, в которой может часто возникать 
ситуация гонки за данные. Архитектура предполагает использовать 
эти очереди для обеспечения потокобезопасности 
потоконебезопасных классов с отложенным вызовом исполнения. Для 
исключения гонки за данные в системе разграничены стадия 
синхронизации и стадия исполнения модулей.

Для взаимодействия между модулями разработан API ядра для 
библиотеки. Модули могут взаимодействовать друг с другом чрез 
рассылку сообщений и через паттерн <<клиент-сервер>>. Для 
повышения производительности после создания буфера сообщения 
через систему передается только указатель на него. Это позволяет 
повысить производительность передачи большого количества данных 
внутри системы. Система коммуникации расчитана для 
взаимодействия в дальнейшем через сеть и использованием модулей, 
написанных на языках, отличных от C++. Для этого передаваемые 
сообщения предлагается сериализировать и использовать 
эффективные алгоритмы десериализации при передачи буфферов 
данных. Так же для переносимости библиотеки на различные 
платформы в библиотеке используются только примитивы из 
стандартной библиотеки C++ и одна сторонняя библиотека с 
кроссплатформенной реализацией очереди без блокировок.

В качестве алгоритмов для сериализации и десериализации выбраны 
реализации Google Protobuf и Flatbuffers. Реализация на Protobuf 
работает с использованием дополнительной мета-таблицы для 
передачи внутри системы исходных структур данных, что 
накладывает существенные ограничения на систему: все сообщения 
должны быть заранее зарегистрированы в этой метатаблице. 
Flatbuffers позволяет передавать сериализированные сообщения без 
существенной потери производительности из-за использования 
десериализации без копирования. При этом архитектура библиотеки 
позволяет использовать любой другой сериализатор.

В работе представлены два прототипа архитектуры системы на 
основе очередей без блокировок: синхронный и асинхронный. 
Синхронная версия разделяет стадию исполнения модулей и 
синхронизации и использует явный интерфейс модуля. В асинхронной 
версии отсутствует понятие модуля: все взаимодействие происходит 
через функции обратного вызова. Так же в асинхронной версии 
предполагается, что потокобезопасность каждого модуля 
обеспечивает разработчик модуля из-за особенностей исполнения. 
При этом асинхронная версия уменьшает количество операций при 
синхронизации данных, что привело к повышению производительности 
в сравнении с синхронной версии.

Тестирование производительности производилось с использованием 
библиотеки Celero, которая позволяет получить результаты с 
использованием таймера с частотой 1МГц. Тестирование 
производилось на мобильном роботе Darwin OP и на современном 
ноутбуке с процессором Intel Core i5 шестого поколения. Данные 
результаты позволяют оценить производительность как на 
маломощных системах, так и на высокопроизводительных. Результаты 
показывают прирост производительности системы передачи сообщений 
в 5-8 раз в сравнении с использованием аналогичных реализаций из 
библиотеки Boost. Система позволяет передавать 100 млн. 
сообщений внутри одного адресного пространства за 1-2 секунды на 
Intel Core i5 и порядка 8 секунд на Intel Atom. Так же 
наблюдается существенный прирост производительности 
разработанной библиотеки при увеличении количества потоков на 
многоядерном процессоре. Можно сказать, что разработанный подход 
к организации межмодульного взаимодействия предоставляет интерес 
как на мобильных роботах, так и на современны высоконагруженных 
системах.

На данный момент планируется дальнейшее применение разработанной системы в СПИИРАНе на мобильных роботах гуманоидных роботах Darwin OP и Antares, который разрабатывается рамках института, для участия в соревновании по футболу роботов RoboCup. В дальнейшем библиотека будет распространяться под лицензией Apache 2.0.